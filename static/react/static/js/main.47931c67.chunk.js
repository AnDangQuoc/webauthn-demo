(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{111:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(11),a=n(79),o=n.n(a);function i(e){if(e instanceof Array){var t,n=[],a=Object(r.a)(e);try{for(a.s();!(t=a.n()).done;){var c=t.value;n.push(i(c))}}catch(l){a.e(l)}finally{a.f()}return n}if(e instanceof ArrayBuffer)return o.a.encode(e);if(e instanceof Object){var s={};for(var u in e)s[u]=i(e[u]);return s}return e}},152:function(e,t,n){"use strict";function r(e){return fetch("/webauthn/register/v2",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}))}function a(e){return fetch("/webauthn/login/v2",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}))}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},190:function(e,t,n){"use strict";(function(e){var r=n(14),a=n.n(r),o=n(40),i=n(3),c=n(4),s=n(125),u=n(133),l=n(126),f=n(2),d=n.n(f),p=n(212),m=n(95),b=n(81),h=n(158),y=n(112),g=n(150),v=(n(225),n(226),n(72)),w=n.n(v),O=n(66),E=n(54),j=n(79),D=n.n(j),C=n(152),S=n(111),k=p.a.TabPane,I={labelCol:{span:8},wrapperCol:{span:16}},x={wrapperCol:{offset:8,span:16}},A=function(t){Object(l.a)(r,t);var n=Object(u.a)(r);function r(){var e;Object(i.a)(this,r);for(var t=arguments.length,c=new Array(t),u=0;u<t;u++)c[u]=arguments[u];return(e=n.call.apply(n,[this].concat(c))).state={options:{},user:{},response:null,challenge:"",getResponse:null,clientData:{}},e.handleRegister=function(){var t=Object(o.a)(a.a.mark((function t(n){var r,o,i,c,u,l;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.username,o=n.name,i=void 0===o?"auto":o,r&&i){t.next=4;break}return alert("Name or username is missing!"),t.abrupt("return");case 4:return e.setState({}),Object(s.a)(e),c=e.createWebauthConfig(r,i),t.prev=7,t.next=10,navigator.credentials.create(c);case 10:return u=t.sent,console.log("create credential response",u),l=Object(S.a)(u),window.dev1=u,e.setState({response:l}),t.next=17,Object(C.b)({username:r,name:i,publicKeyCredential:l});case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(7),m.b.error(t.t0.message);case 22:case"end":return t.stop()}}),t,null,[[7,19]])})));return function(e){return t.apply(this,arguments)}}(),e.handleLogin=function(){var t=Object(o.a)(a.a.mark((function t(n){var r,o,i,c,s,u,l;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.username2,o=e.state,i=o.response,c=o.attestation,i&&c){t.next=5;break}return m.b.error("Not registered"),t.abrupt("return");case 5:if(r){t.next=8;break}return m.b.error("Username is missing!"),t.abrupt("return");case 8:return s=e.createWebauthGetConfig(),t.prev=9,t.next=12,navigator.credentials.get(s);case 12:return u=t.sent,console.log("Get credieantial response",u),window.dev2=u,e.setState({getResponse:Object(S.a)(u),parse:Object(O.d)(u)}),l=Object(S.a)(u),t.next=19,Object(C.a)({username:r,publicKeyCredential:l});case 19:m.b.success("OK"),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(9),m.b.error(t.t0.message);case 25:case"end":return t.stop()}}),t,null,[[9,22]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(c.a)(r,[{key:"componentDidMount",value:function(){var t=Object(o.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();case 2:t.sent||m.b.error("Webauthnn not support"),window.parseAttestationObject=O.a,window.parseCredentials=O.d,window.parseAuthenticatorData=O.b,window.publicKeyCredentialToJSON=S.a,window.base64url=D.a,window.derToPem=E.b,window.dev=crypto,window.buff=e;case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"createWebauthConfig",value:function(e,t){var n=new Uint8Array(32),r=new Uint8Array(32);crypto.getRandomValues(n),crypto.getRandomValues(r);var a={publicKey:{challenge:n,rp:{name:"Webauthn Play",id:"webauthnplay.herokuapp.com"},user:{id:r,name:e,displayName:t},attestation:"direct",authenticatorSelection:{authenticatorAttachment:"platform"},pubKeyCredParams:[{type:"public-key",alg:-7}]}};return this.setState({challenge:n,user:{id:r,name:e,displayName:t},options:a}),a}},{key:"createWebauthGetConfig",value:function(){var e=this.state,t=e.challenge,n=(e.user,e.response);if(n)return{publicKey:{challenge:t,allowCredientails:[{type:"public-key",id:n.rawId,transports:["usb","ble","nfc","internal"]}]}}}},{key:"parseCreateCredentialResponse",value:function(e){var t=new TextDecoder("utf-8").decode(e.response.clientDataJSON),n=JSON.parse(t),r=w.a.decodeAllSync(e.response.attestationObject)[0].authData,a=new DataView(new ArrayBuffer(2));r.slice(53,55).forEach((function(e,t){return a.setUint8(t,e)}));var o=a.getUint16(),i=(r.slice(55,55+o),r.slice(55+o));return{clientDataObj:n,publicKeyObject:w.a.decode(i.buffer)}}},{key:"parseGetCredentialResponse",value:function(e){return{clientData:JSON.parse(D.a.decode(e.response.clientDataJSON)),authenticatorData:Object(O.b)(D.a.toBuffer(e.response.authenticatorData)),userHandle:D.a.decode(e.response.userHandle)}}},{key:"render",value:function(){var e=this.state,t=(e.options,e.user,e.response),n=(e.challenge,e.getResponse);return d.a.createElement("div",{className:"card-container"},d.a.createElement(p.a,{type:"card"},d.a.createElement(k,{tab:"Register",key:"1"},d.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},d.a.createElement(b.a,Object.assign({onFinish:this.handleRegister},I,{id:"form_register"}),d.a.createElement(b.a.Item,{label:"User Name",name:"username",rules:[{required:!0,message:"Please input your username!"}]},d.a.createElement(h.a,null)),d.a.createElement(b.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input your name!"}]},d.a.createElement(h.a,null)),d.a.createElement(b.a.Item,x,d.a.createElement(y.a,{type:"primary",htmlType:"submit",form:"form_register"},"Register"))))),d.a.createElement(k,{tab:"Login",key:"2"},d.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},d.a.createElement(b.a,{onFinish:this.handleLogin,id:"form_update"},d.a.createElement(b.a.Item,{label:"User Name",name:"username2",rules:[{required:!0,message:"Please input your username!"}]},d.a.createElement(h.a,null)),d.a.createElement(b.a.Item,x,d.a.createElement(y.a,{type:"primary",htmlType:"submit",form:"form_update"},"Login")))))),t?d.a.createElement("div",null," ",d.a.createElement("p",null,"Create Credential Response")," ",d.a.createElement("br",null),d.a.createElement(g.a,{value:{raw:t}})):d.a.createElement("div",null),n?d.a.createElement("div",null,d.a.createElement("p",null,"Get Credential Response")," ",d.a.createElement("br",null),d.a.createElement(g.a,{value:{raw:n}})):d.a.createElement("div",null))}}]),r}(d.a.Component);t.a=A}).call(this,n(23).Buffer)},194:function(e,t,n){"use strict";t.a={"1.2.840.113549.1.1.11":"sha256WithRSAEncryption"}},213:function(e,t,n){e.exports=n(389)},219:function(e,t,n){},248:function(e,t){},250:function(e,t){},281:function(e,t){},389:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),o=n(20),i=n.n(o),c=(n(218),n(219),n(190));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(c.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},54:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return u}));n(38);var r=n(11),a=(n(194),n(0),n(209),n(72));function o(e){var t={};for(var n in e){var r=e[n];"object"===typeof r?Array.isArray(r)||r instanceof ArrayBuffer||r&&"length"in r?t[n]=r.slice():t[n]=o(r):t[n]=r}return t}function i(e,t){var n,a={},o=Object(r.a)(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;i in e&&(a[i]=e[i])}}catch(c){o.e(c)}finally{o.f()}return a}function c(e,t){Object.keys(e).forEach((function(n){n in t&&(e[n]=t[n].transform(e[n])),"object"===typeof e[n]&&c(e[n],t)}))}function s(t){for(var n=e.from(t).toString("base64"),r="",a=0;a<n.length;++a)r+=a%64===0?"\r\n".concat(n[a]):n[a];return"-----BEGIN CERTIFICATE-----"+"".concat(r,"\r\n")+"-----END CERTIFICATE-----"}function u(e){return JSON.stringify(e,null,2)}new(n.n(a).a.Encoder)({genTypes:[ArrayBuffer,function(t,n){return t.pushAny(e.from(n))}]})}).call(this,n(23).Buffer)},66:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return d}));n(11);var r=n(54),a=n(94),o=n(72),i=n.n(o),c=n(151),s=n.n(c);function u(t){for(var n=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),r=0,a={rpIdHash:""},o=r+32;r<o;++r)a.rpIdHash+=n.getUint8(r).toString(16);var c=n.getUint8(r++);if(a.flags={userPresent:0!==(1&c),reserved1:0!==(2&c),userVerified:0!==(4&c),reserved2:((56&c)>>>3).toString(16),attestedCredentialData:0!==(64&c),extensionDataIncluded:0!==(128&c)},a.signCount=n.getUint32(r,!1),r+=4,a.flags.attestedCredentialData){var u={};a.attestedCredentialData=u,u.aaguid="";for(var l=r+16;r<l;++r)u.aaguid+=n.getUint8(r).toString(16);u.credentialIdLength=n.getUint16(r,!1),r+=2,u.credentialId="";for(var f=r+u.credentialIdLength;r<f;++r)u.credentialId+=n.getUint8(r).toString(16);try{var d=e.from(n.buffer,n.byteOffset+r);u.credentialPublicKey=i.a.encode(i.a.decodeFirstSync(d))}catch(p){s.a.error("Failed to decode CBOR data: ",p),u.credentialPublicKey="Decode error: ".concat(p.toString())}}return a.flags.extensionDataIncluded,a}function l(t){var n=t instanceof ArrayBuffer?e.from(t):e.from(t.buffer,t.byteOffset,t.byteLength);try{var r=i.a.decodeFirstSync(n);return r.authData&&(r.authData=u(r.authData)),r}catch(o){var a="Failed to decode attestationObject, unknown attestation type?";return s.a.error(a),a}}function f(e){var t=new TextDecoder("utf-8").decode(e);return JSON.parse(t)}function d(e){var t=Object(r.a)(e),n=Object(r.c)(a.a,["clientDataJSON","authenticatorData","attestationObject"]);return Object(r.e)(t,n),t}}).call(this,n(23).Buffer)},94:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var r=n(66),a=n(195);function o(t){if(!(t instanceof e))try{t=e.from(t)}catch(n){return""}return t.toString("hex")}var i={rawId:{transform:o,buttons:["Use","Download"]},sig:{transform:o,buttons:["Download"]},signature:{transform:o,buttons:["Download"]},userHandle:{transform:o,buttons:["Download"]},x5c:{transform:function(e){return e.map(o)},buttons:["View","Download PEM"]},credentialPublicKey:{transform:n.n(a).a,buttons:["Download COSE","Download JWK","Download PEM"]},authenticatorData:{transform:r.b},attestationObject:{transform:r.a},clientDataJSON:{transform:r.c}}}).call(this,n(23).Buffer)}},[[213,1,2]]]);
//# sourceMappingURL=main.47931c67.chunk.js.map