(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{101:function(e,t,r){"use strict";(function(e){r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return u}));r(11),r(63),r(90);var n=r(88),a=r.n(n),i=r(142),o=r.n(i);function c(t){for(var r=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),n=0,i={rpIdHash:""},c=n+32;n<c;++n)i.rpIdHash+=r.getUint8(n).toString(16);var s=r.getUint8(n++);if(i.flags={userPresent:0!==(1&s),reserved1:0!==(2&s),userVerified:0!==(4&s),reserved2:((56&s)>>>3).toString(16),attestedCredentialData:0!==(64&s),extensionDataIncluded:0!==(128&s)},i.signCount=r.getUint32(n,!1),n+=4,i.flags.attestedCredentialData){var u={};i.attestedCredentialData=u,u.aaguid="";for(var l=n+16;n<l;++n)u.aaguid+=r.getUint8(n).toString(16);u.credentialIdLength=r.getUint16(n,!1),n+=2,u.credentialId="";for(var f=n+u.credentialIdLength;n<f;++n)u.credentialId+=r.getUint8(n).toString(16);try{var d=e.from(r.buffer,r.byteOffset+n);u.credentialPublicKey=a.a.encode(a.a.decodeFirstSync(d))}catch(h){o.a.error("Failed to decode CBOR data: ",h),u.credentialPublicKey="Decode error: ".concat(h.toString())}}return i.flags.extensionDataIncluded,i}function s(t){var r=t instanceof ArrayBuffer?e.from(t):e.from(t.buffer,t.byteOffset,t.byteLength);try{var n=a.a.decodeFirstSync(r);return n.authData&&(n.authData=c(n.authData)),n}catch(s){var i="Failed to decode attestationObject, unknown attestation type?";return o.a.error(i),i}}function u(e){var t=new TextDecoder("utf-8").decode(e);return JSON.parse(t)}}).call(this,r(24).Buffer)},179:function(e,t,r){"use strict";t.a={"1.2.840.113549.1.1.11":"sha256WithRSAEncryption"}},197:function(e,t,r){e.exports=r(361)},203:function(e,t,r){},215:function(e,t){},217:function(e,t){},247:function(e,t){},361:function(e,t,r){"use strict";r.r(t);var n=r(2),a=r.n(n),i=r(20),o=r.n(i),c=(r(202),r(203),r(14)),s=r.n(c),u=r(38),l=r(3),f=r(4),d=r(126),h=r(127),m=r(364),p=r(367),b=r(363),g=r(366),y=r(148),v=(r(204),r(208),r(101),r(118)),w=r.n(v);function I(e){return fetch("/webauthn/register/v2",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}))}function E(e){return fetch("/webauthn/verify/v2",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}))}var S=r(11);function k(e){if(e instanceof Array){var t,r=[],n=Object(S.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;r.push(k(a))}}catch(c){n.e(c)}finally{n.f()}return r}if(e instanceof ArrayBuffer)return w.a.encode(e);if(e instanceof Object){var i={};for(var o in e)i[o]=k(e[o]);return i}return e}var O=m.a.TabPane,A={labelCol:{span:8},wrapperCol:{span:16}},C={wrapperCol:{offset:8,span:16}},j=function(e){Object(h.a)(r,e);var t=Object(d.a)(r);function r(){var e;Object(l.a)(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={},e.handleRegister=function(){var t=Object(u.a)(s.a.mark((function t(r){var n,a,i,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.username,a=r.name,i=void 0===a?"auto":a,n&&i){t.next=4;break}return p.b.error("Name or username is missing!"),t.abrupt("return");case 4:return t.prev=4,o=e.createWebauthConfig(n,i),t.abrupt("return",e.beginRegister(o,n,i));case 9:t.prev=9,t.t0=t.catch(4),p.b.error(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[4,9]])})));return function(e){return t.apply(this,arguments)}}(),e.beginRegister=function(){var t=Object(u.a)(s.a.mark((function t(r,n,a){var i,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.credentials.create(r);case 3:return i=t.sent,o=k(i),t.next=7,I({username:n,name:a,publicKeyCredential:o});case 7:localStorage.setItem("webAuthId",i.rawId),e.setState({webAuthId:i.rawId}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),p.b.error(t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,r,n){return t.apply(this,arguments)}}(),e.handleLogin=function(){var t=Object(u.a)(s.a.mark((function t(r){var n,a,i,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.username2){t.next=4;break}return p.b.error("Username is missing!"),t.abrupt("return");case 4:return t.prev=4,a=e.createWebauthGetConfig(),t.next=8,navigator.credentials.get(a);case 8:return i=t.sent,o=k(i),t.next=12,E({username:n,publicKeyCredential:o});case 12:t.sent.result?p.b.success("Verified"):p.b.error("Not Verified"),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),p.b.error(t.t0.message);case 19:case"end":return t.stop()}}),t,null,[[4,16]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(f.a)(r,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();case 2:if(e.sent||p.b.error("Webauthnn not support"),t=localStorage.getItem("webAuthn"),r=localStorage.getItem("webAuthId"),t){e.next=20;break}return e.prev=7,e.next=10,fetch("/webauthn/init",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}));case 10:n=e.sent,localStorage.setItem("webAuthn",JSON.stringify({challenge:n.challenge,userId:n.userId})),this.setState({challenge:n.challenge,userId:n.userId,webAuthId:r}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),p.b.error(e.t0.message);case 18:e.next=22;break;case 20:JSON.parse(t),this.setState({challenge:t.challenge,userId:t.userId,webAuthId:r});case 22:case"end":return e.stop()}}),e,this,[[7,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"createWebauthConfig",value:function(e,t){var r=this.state,n=r.challenge,a=r.userId;return{publicKey:{challenge:Uint8Array.from(n,(function(e){return e.charCodeAt(0)})),rp:{name:"Webauthn Play",id:"webauthnplay.herokuapp.com"},user:{id:Uint8Array.from(a,(function(e){return e.charCodeAt(0)})),name:e,displayName:t},attestation:"direct",authenticatorSelection:{authenticatorAttachment:"platform"},pubKeyCredParams:[{type:"public-key",alg:-7}]}}}},{key:"createWebauthGetConfig",value:function(){var e=this.state,t=e.challenge,r=e.webAuthId;return{publicKey:{challenge:Uint8Array.from(t,(function(e){return e.charCodeAt(0)})),allowCredentials:[{type:"public-key",id:w.a.toBuffer(r),transports:["usb","ble","nfc","internal"]}]}}}},{key:"render",value:function(){return a.a.createElement("div",{className:"card-container"},a.a.createElement(m.a,{type:"card"},a.a.createElement(O,{tab:"Register",key:"1"},a.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},a.a.createElement(b.a,Object.assign({onFinish:this.handleRegister},A,{id:"form_register"}),a.a.createElement(b.a.Item,{label:"User Name",name:"username",rules:[{required:!0,message:"Please input your username!"}]},a.a.createElement(g.a,null)),a.a.createElement(b.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input your name!"}]},a.a.createElement(g.a,null)),a.a.createElement(b.a.Item,C,a.a.createElement(y.a,{type:"primary",htmlType:"submit",form:"form_register"},"Register"))))),a.a.createElement(O,{tab:"Login",key:"2"},a.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},a.a.createElement(b.a,{onFinish:this.handleLogin,id:"form_update"},a.a.createElement(b.a.Item,{label:"User Name",name:"username2",rules:[{required:!0,message:"Please input your username!"}]},a.a.createElement(g.a,null)),a.a.createElement(b.a.Item,C,a.a.createElement(y.a,{type:"primary",htmlType:"submit",form:"form_update"},"Login")))))))}}]),r}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},63:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"c",(function(){return s}));r(37);var n=r(11),a=(r(179),r(0),r(194),r(88));function i(e){var t={};for(var r in e){var n=e[r];"object"===typeof n?Array.isArray(n)||n instanceof ArrayBuffer||n&&"length"in n?t[r]=n.slice():t[r]=i(n):t[r]=n}return t}function o(e,t){var r,a={},i=Object(n.a)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;o in e&&(a[o]=e[o])}}catch(c){i.e(c)}finally{i.f()}return a}function c(e,t){Object.keys(e).forEach((function(r){r in t&&(e[r]=t[r].transform(e[r])),"object"===typeof e[r]&&c(e[r],t)}))}function s(e){return JSON.stringify(e,null,2)}new(r.n(a).a.Encoder)({genTypes:[ArrayBuffer,function(t,r){return t.pushAny(e.from(r))}]})}).call(this,r(24).Buffer)},90:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return o}));var n=r(101),a=r(180);function i(t){if(!(t instanceof e))try{t=e.from(t)}catch(r){return""}return t.toString("hex")}var o={rawId:{transform:i,buttons:["Use","Download"]},sig:{transform:i,buttons:["Download"]},signature:{transform:i,buttons:["Download"]},userHandle:{transform:i,buttons:["Download"]},x5c:{transform:function(e){return e.map(i)},buttons:["View","Download PEM"]},credentialPublicKey:{transform:r.n(a).a,buttons:["Download COSE","Download JWK","Download PEM"]},authenticatorData:{transform:n.b},attestationObject:{transform:n.a},clientDataJSON:{transform:n.c}}}).call(this,r(24).Buffer)}},[[197,1,2]]]);
//# sourceMappingURL=main.40f5f348.chunk.js.map