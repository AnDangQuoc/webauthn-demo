(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{101:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var a=n(63),r=n(250);function o(t){if(!(t instanceof e))try{t=e.from(t)}catch(n){return""}return t.toString("hex")}var i={rawId:{transform:o,buttons:["Use","Download"]},sig:{transform:o,buttons:["Download"]},signature:{transform:o,buttons:["Download"]},userHandle:{transform:o,buttons:["Download"]},x5c:{transform:function(e){return e.map(o)},buttons:["View","Download PEM"]},credentialPublicKey:{transform:n.n(r).a,buttons:["Download COSE","Download JWK","Download PEM"]},authenticatorData:{transform:a.b},attestationObject:{transform:a.a},clientDataJSON:{transform:a.c}}}).call(this,n(15).Buffer)},249:function(e,t,n){"use strict";t.a={"1.2.840.113549.1.1.11":"sha256WithRSAEncryption"}},267:function(e,t,n){e.exports=n(508)},273:function(e,t,n){},299:function(e,t){},301:function(e,t){},333:function(e,t){},334:function(e,t){},400:function(e,t){},508:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(23),i=n.n(o),s=(n(272),n(273),n(17)),c=n.n(s),u=n(44),l=n(3),f=n(4),d=n(138),p=n(146),m=n(139),b=n(512),h=n(515),g=n(511),y=n(514),v=n(183),w=n(176),O=(n(277),n(278),n(147)),E=n.n(O),C=n(63),j=n(56),D=n(78),S=n.n(D);function k(e){return fetch("/webauthn/register/v2",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}))}function I(e){return fetch("/webauthn/login/v2",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}))}var x=n(11);function N(e){if(e instanceof Array){var t,n=[],a=Object(x.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n.push(N(r))}}catch(s){a.e(s)}finally{a.f()}return n}if(e instanceof ArrayBuffer)return S.a.encode(e);if(e instanceof Object){var o={};for(var i in e)o[i]=N(e[i]);return o}return e}var A=b.a.TabPane,R={labelCol:{span:8},wrapperCol:{span:16}},P={wrapperCol:{offset:8,span:16}},T=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={options:{},user:{},response:null,challenge:"",getResponse:null,isUpdate:!0},e.handleRegister=function(){var t=Object(u.a)(c.a.mark((function t(n){var a,r,o,i,s,u,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.username,r=n.name,o=void 0===r?"auto":r,a&&o){t.next=4;break}return alert("Name or username is missing!"),t.abrupt("return");case 4:return e.setState({}),Object(d.a)(e),i=e.createWebauthConfig(a,o),t.prev=7,t.next=10,navigator.credentials.create(i);case 10:return s=t.sent,console.log("create credential response",s),u=N(s),console.log("Body 1",u),window.dev1=s,l=Object(C.a)(s.response.attestationObject),console.log("parsed credential",l),e.setState({response:N(s),attestation:l}),t.next=20,k({username:a,name:o,publicKeyCredential:Object(j.b)(l.authData.attestedCredentialData.credentialPublicKey)});case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(7),h.b.error(t.t0.message);case 25:case"end":return t.stop()}}),t,null,[[7,22]])})));return function(e){return t.apply(this,arguments)}}(),e.handleLogin=function(){var t=Object(u.a)(c.a.mark((function t(n){var a,r,o,i,s,u,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.username2,r=e.state,o=r.response,i=r.attestation,o&&i){t.next=5;break}return h.b.error("Not registered"),t.abrupt("return");case 5:if(a){t.next=8;break}return h.b.error("Username is missing!"),t.abrupt("return");case 8:return s=e.createWebauthGetConfig(),t.prev=9,t.next=12,navigator.credentials.get(s);case 12:return u=t.sent,console.log("Get credieantial response",u),window.dev2=u,e.setState({getResponse:N(u),parse:Object(C.d)(u)}),l=N(u),t.next=19,I({username:a,publicKeyCredential:l});case 19:h.b.success("OK"),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(9),h.b.error(t.t0.message);case 25:case"end":return t.stop()}}),t,null,[[9,22]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();case 2:(t=e.sent)||h.b.error("Webauthnn not support"),console.log(t),window.parseAttestationObject=C.a,window.parseCredentials=C.d,window.parseAuthenticatorData=C.b,window.publicKeyCredentialToJSON=N,window.base64url=S.a,window.derToPem=j.b,window.dev=E.a;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"createWebauthConfig",value:function(e,t){var n=new Uint8Array(32),a=new Uint8Array(32);E.a.getRandomValues(n),E.a.getRandomValues(a);var r={publicKey:{challenge:n,rp:{name:"webauthnplay.herokuapp.com"},user:{id:a,name:e,displayName:t},attestation:"direct",pubKeyCredParams:[{type:"public-key",alg:-7}],authenticatorSelection:{authenticatorAttachment:"platform"}}};return this.setState({challenge:n,user:{id:a,name:e,displayName:t},options:r}),r}},{key:"createWebauthGetConfig",value:function(){var e=this.state,t=e.challenge,n=(e.user,e.response);if(n)return{publicKey:{challenge:t,allowCredientails:[{type:"public-key",id:n.rawId}]}}}},{key:"parseCreateCredentialResponse",value:function(e){return{clientData:JSON.parse(S.a.decode(e.response.clientDataJSON)),attestationObject:Object(C.a)(S.a.toBuffer(e.response.attestationObject))}}},{key:"parseGetCredentialResponse",value:function(e){return{clientData:JSON.parse(S.a.decode(e.response.clientDataJSON)),authenticatorData:Object(C.b)(S.a.toBuffer(e.response.authenticatorData)),userHandle:S.a.decode(e.response.userHandle)}}},{key:"render",value:function(){var e=this.state,t=(e.options,e.user,e.response),n=(e.challenge,e.getResponse);return r.a.createElement("div",{className:"card-container"},r.a.createElement(b.a,{type:"card"},r.a.createElement(A,{tab:"Register",key:"1"},r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(g.a,Object.assign({onFinish:this.handleRegister},R,{id:"form_register"}),r.a.createElement(g.a.Item,{label:"User Name",name:"username",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(y.a,null)),r.a.createElement(g.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input your name!"}]},r.a.createElement(y.a,null)),r.a.createElement(g.a.Item,P,r.a.createElement(v.a,{type:"primary",htmlType:"submit",form:"form_register"},"Register"))))),r.a.createElement(A,{tab:"Login",key:"2"},r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(g.a,{onFinish:this.handleLogin,id:"form_update"},r.a.createElement(g.a.Item,{label:"User Name",name:"username2",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(y.a,null)),r.a.createElement(g.a.Item,P,r.a.createElement(v.a,{type:"primary",htmlType:"submit",form:"form_update"},"Login")))))),t?r.a.createElement("div",null," ",r.a.createElement("p",null,"Create Credential Response")," ",r.a.createElement("br",null),r.a.createElement(w.a,{value:{raw:t,parsed:this.parseCreateCredentialResponse(t)}})):r.a.createElement("div",null),n?r.a.createElement("div",null,r.a.createElement("p",null,"Get Credential Response")," ",r.a.createElement("br",null),r.a.createElement(w.a,{value:{raw:n,parsed:this.parseGetCredentialResponse(n)}})):r.a.createElement("div",null))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},56:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u}));n(41);var a=n(11),r=(n(249),n(0),n(264),n(99));function o(e){var t={};for(var n in e){var a=e[n];"object"===typeof a?Array.isArray(a)||a instanceof ArrayBuffer||a&&"length"in a?t[n]=a.slice():t[n]=o(a):t[n]=a}return t}function i(e,t){var n,r={},o=Object(a.a)(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;i in e&&(r[i]=e[i])}}catch(s){o.e(s)}finally{o.f()}return r}function s(e,t){Object.keys(e).forEach((function(n){n in t&&(e[n]=t[n].transform(e[n])),"object"===typeof e[n]&&s(e[n],t)}))}function c(t){for(var n=e.from(t).toString("base64"),a="",r=0;r<n.length;++r)a+=r%64===0?"\r\n".concat(n[r]):n[r];return"-----BEGIN CERTIFICATE-----"+"".concat(a,"\r\n")+"-----END CERTIFICATE-----"}function u(e){return JSON.stringify(e,null,2)}new(n.n(r).a.Encoder)({genTypes:[ArrayBuffer,function(t,n){return t.pushAny(e.from(n))}]})}).call(this,n(15).Buffer)},63:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return d}));n(11);var a=n(56),r=n(101),o=n(99),i=n.n(o),s=n(177),c=n.n(s);function u(t){for(var n=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),a=0,r={rpIdHash:""},o=a+32;a<o;++a)r.rpIdHash+=n.getUint8(a).toString(16);var s=n.getUint8(a++);if(r.flags={userPresent:0!==(1&s),reserved1:0!==(2&s),userVerified:0!==(4&s),reserved2:((56&s)>>>3).toString(16),attestedCredentialData:0!==(64&s),extensionDataIncluded:0!==(128&s)},r.signCount=n.getUint32(a,!1),a+=4,r.flags.attestedCredentialData){var u={};r.attestedCredentialData=u,u.aaguid="";for(var l=a+16;a<l;++a)u.aaguid+=n.getUint8(a).toString(16);u.credentialIdLength=n.getUint16(a,!1),a+=2,u.credentialId="";for(var f=a+u.credentialIdLength;a<f;++a)u.credentialId+=n.getUint8(a).toString(16);try{var d=e.from(n.buffer,n.byteOffset+a);u.credentialPublicKey=i.a.encode(i.a.decodeFirstSync(d))}catch(p){c.a.error("Failed to decode CBOR data: ",p),u.credentialPublicKey="Decode error: ".concat(p.toString())}}return r.flags.extensionDataIncluded,r}function l(t){var n=t instanceof ArrayBuffer?e.from(t):e.from(t.buffer,t.byteOffset,t.byteLength);try{var a=i.a.decodeFirstSync(n);return a.authData&&(a.authData=u(a.authData)),a}catch(o){var r="Failed to decode attestationObject, unknown attestation type?";return c.a.error(r),r}}function f(e){var t=new TextDecoder("utf-8").decode(e);return JSON.parse(t)}function d(e){var t=Object(a.a)(e),n=Object(a.c)(r.a,["clientDataJSON","authenticatorData","attestationObject"]);return Object(a.e)(t,n),t}}).call(this,n(15).Buffer)}},[[267,1,2]]]);
//# sourceMappingURL=main.f8ce9d43.chunk.js.map