(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{102:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var a=n(67),r=n(256);function o(t){if(!(t instanceof e))try{t=e.from(t)}catch(n){return""}return t.toString("hex")}var i={rawId:{transform:o,buttons:["Use","Download"]},sig:{transform:o,buttons:["Download"]},signature:{transform:o,buttons:["Download"]},userHandle:{transform:o,buttons:["Download"]},x5c:{transform:function(e){return e.map(o)},buttons:["View","Download PEM"]},credentialPublicKey:{transform:n.n(r).a,buttons:["Download COSE","Download JWK","Download PEM"]},authenticatorData:{transform:a.b},attestationObject:{transform:a.a},clientDataJSON:{transform:a.c}}}).call(this,n(15).Buffer)},103:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(11),r=n(86),o=n.n(r);function i(e){if(e instanceof Array){var t,n=[],r=Object(a.a)(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;n.push(i(s))}}catch(l){r.e(l)}finally{r.f()}return n}if(e instanceof ArrayBuffer)return o.a.encode(e);if(e instanceof Object){var c={};for(var u in e)c[u]=i(e[u]);return c}return e}},182:function(e,t,n){"use strict";function a(e){return fetch("/webauthn/register/v2",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}))}function r(e){return fetch("/webauthn/login/v2",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}))}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}))},251:function(e,t,n){"use strict";(function(e){var a=n(17),r=n.n(a),o=n(44),i=n(3),s=n(4),c=n(142),u=n(150),l=n(143),f=n(2),d=n.n(f),p=n(273),m=n(104),b=n(88),h=n(188),y=n(125),g=n(180),v=(n(286),n(287),n(151)),w=n.n(v),O=n(78),E=n.n(O),j=n(67),C=n(62),D=n(86),S=n.n(D),k=n(182),I=n(103),x=p.a.TabPane,A={labelCol:{span:8},wrapperCol:{span:16}},N={wrapperCol:{offset:8,span:16}},R=function(t){Object(l.a)(a,t);var n=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var t=arguments.length,s=new Array(t),u=0;u<t;u++)s[u]=arguments[u];return(e=n.call.apply(n,[this].concat(s))).state={options:{},user:{},response:null,challenge:"",getResponse:null,clientData:{}},e.handleRegister=function(){var t=Object(o.a)(r.a.mark((function t(n){var a,o,i,s,u,l,f;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.username,o=n.name,i=void 0===o?"auto":o,a&&i){t.next=4;break}return alert("Name or username is missing!"),t.abrupt("return");case 4:return e.setState({}),Object(c.a)(e),s=e.createWebauthConfig(a,i),t.prev=7,t.next=10,navigator.credentials.create(s);case 10:return u=t.sent,console.log("create credential response",u),l=Object(I.a)(u),window.dev1=u,f=Object(j.a)(u.response.attestationObject),console.log("parsed credential",f),e.setState({response:Object(I.a)(u),attestation:f}),t.next=19,Object(k.b)({username:a,name:i,publicKeyCredential:l});case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(7),m.b.error(t.t0.message);case 24:case"end":return t.stop()}}),t,null,[[7,21]])})));return function(e){return t.apply(this,arguments)}}(),e.handleLogin=function(){var t=Object(o.a)(r.a.mark((function t(n){var a,o,i,s,c,u,l;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.username2,o=e.state,i=o.response,s=o.attestation,i&&s){t.next=5;break}return m.b.error("Not registered"),t.abrupt("return");case 5:if(a){t.next=8;break}return m.b.error("Username is missing!"),t.abrupt("return");case 8:return c=e.createWebauthGetConfig(),t.prev=9,t.next=12,navigator.credentials.get(c);case 12:return u=t.sent,console.log("Get credieantial response",u),window.dev2=u,e.setState({getResponse:Object(I.a)(u),parse:Object(j.d)(u)}),l=Object(I.a)(u),t.next=19,Object(k.a)({username:a,publicKeyCredential:l});case 19:m.b.success("OK"),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(9),m.b.error(t.t0.message);case 25:case"end":return t.stop()}}),t,null,[[9,22]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var t=Object(o.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();case 2:t.sent||m.b.error("Webauthnn not support"),window.parseAttestationObject=j.a,window.parseCredentials=j.d,window.parseAuthenticatorData=j.b,window.publicKeyCredentialToJSON=I.a,window.base64url=S.a,window.derToPem=C.b,window.dev=w.a,window.buff=e;case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"createWebauthConfig",value:function(e,t){var n=new Uint8Array(32),a=new Uint8Array(32);w.a.getRandomValues(n),w.a.getRandomValues(a);var r={publicKey:{challenge:n,rp:{name:"Webauthn Play",id:"webauthnplay.herokuapp.com"},user:{id:a,name:e,displayName:t},attestation:"direct",authenticatorSelection:{authenticatorAttachment:"platform"},pubKeyCredParams:[{type:"public-key",alg:-7}]}};return this.setState({challenge:n,user:{id:a,name:e,displayName:t},options:r}),r}},{key:"createWebauthGetConfig",value:function(){var e=this.state,t=e.challenge,n=(e.user,e.response);if(n)return{publicKey:{challenge:t,allowCredientails:[{type:"public-key",id:n.rawId,transports:["usb","ble","nfc","internal"]}]}}}},{key:"parseCreateCredentialResponse",value:function(e){var t=new TextDecoder("utf-8").decode(e.response.clientDataJSON),n=JSON.parse(t),a=E.a.decodeAllSync(e.response.attestationObject)[0].authData,r=new DataView(new ArrayBuffer(2));a.slice(53,55).forEach((function(e,t){return r.setUint8(t,e)}));var o=r.getUint16(),i=(a.slice(55,55+o),a.slice(55+o));return{clientDataObj:n,publicKeyObject:E.a.decode(i.buffer)}}},{key:"parseGetCredentialResponse",value:function(e){return{clientData:JSON.parse(S.a.decode(e.response.clientDataJSON)),authenticatorData:Object(j.b)(S.a.toBuffer(e.response.authenticatorData)),userHandle:S.a.decode(e.response.userHandle)}}},{key:"render",value:function(){var e=this.state,t=(e.options,e.user,e.response),n=(e.challenge,e.getResponse);return d.a.createElement("div",{className:"card-container"},d.a.createElement(p.a,{type:"card"},d.a.createElement(x,{tab:"Register",key:"1"},d.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},d.a.createElement(b.a,Object.assign({onFinish:this.handleRegister},A,{id:"form_register"}),d.a.createElement(b.a.Item,{label:"User Name",name:"username",rules:[{required:!0,message:"Please input your username!"}]},d.a.createElement(h.a,null)),d.a.createElement(b.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input your name!"}]},d.a.createElement(h.a,null)),d.a.createElement(b.a.Item,N,d.a.createElement(y.a,{type:"primary",htmlType:"submit",form:"form_register"},"Register"))))),d.a.createElement(x,{tab:"Login",key:"2"},d.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},d.a.createElement(b.a,{onFinish:this.handleLogin,id:"form_update"},d.a.createElement(b.a.Item,{label:"User Name",name:"username2",rules:[{required:!0,message:"Please input your username!"}]},d.a.createElement(h.a,null)),d.a.createElement(b.a.Item,N,d.a.createElement(y.a,{type:"primary",htmlType:"submit",form:"form_update"},"Login")))))),t?d.a.createElement("div",null," ",d.a.createElement("p",null,"Create Credential Response")," ",d.a.createElement("br",null),d.a.createElement(g.a,{value:{raw:t,parsed:this.parseCreateCredentialResponse(t)}})):d.a.createElement("div",null),n?d.a.createElement("div",null,d.a.createElement("p",null,"Get Credential Response")," ",d.a.createElement("br",null),d.a.createElement(g.a,{value:{raw:n,parsed:this.parseGetCredentialResponse(n)}})):d.a.createElement("div",null))}}]),a}(d.a.Component);t.a=R}).call(this,n(15).Buffer)},255:function(e,t,n){"use strict";t.a={"1.2.840.113549.1.1.11":"sha256WithRSAEncryption"}},274:function(e,t,n){e.exports=n(515)},280:function(e,t,n){},306:function(e,t){},308:function(e,t){},340:function(e,t){},341:function(e,t){},407:function(e,t){},515:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(23),i=n.n(o),s=(n(279),n(280),n(251));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(s.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},62:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u}));n(41);var a=n(11),r=(n(255),n(0),n(270),n(78));function o(e){var t={};for(var n in e){var a=e[n];"object"===typeof a?Array.isArray(a)||a instanceof ArrayBuffer||a&&"length"in a?t[n]=a.slice():t[n]=o(a):t[n]=a}return t}function i(e,t){var n,r={},o=Object(a.a)(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;i in e&&(r[i]=e[i])}}catch(s){o.e(s)}finally{o.f()}return r}function s(e,t){Object.keys(e).forEach((function(n){n in t&&(e[n]=t[n].transform(e[n])),"object"===typeof e[n]&&s(e[n],t)}))}function c(t){for(var n=e.from(t).toString("base64"),a="",r=0;r<n.length;++r)a+=r%64===0?"\r\n".concat(n[r]):n[r];return"-----BEGIN CERTIFICATE-----"+"".concat(a,"\r\n")+"-----END CERTIFICATE-----"}function u(e){return JSON.stringify(e,null,2)}new(n.n(r).a.Encoder)({genTypes:[ArrayBuffer,function(t,n){return t.pushAny(e.from(n))}]})}).call(this,n(15).Buffer)},67:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return d}));n(11);var a=n(62),r=n(102),o=n(78),i=n.n(o),s=n(181),c=n.n(s);function u(t){for(var n=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),a=0,r={rpIdHash:""},o=a+32;a<o;++a)r.rpIdHash+=n.getUint8(a).toString(16);var s=n.getUint8(a++);if(r.flags={userPresent:0!==(1&s),reserved1:0!==(2&s),userVerified:0!==(4&s),reserved2:((56&s)>>>3).toString(16),attestedCredentialData:0!==(64&s),extensionDataIncluded:0!==(128&s)},r.signCount=n.getUint32(a,!1),a+=4,r.flags.attestedCredentialData){var u={};r.attestedCredentialData=u,u.aaguid="";for(var l=a+16;a<l;++a)u.aaguid+=n.getUint8(a).toString(16);u.credentialIdLength=n.getUint16(a,!1),a+=2,u.credentialId="";for(var f=a+u.credentialIdLength;a<f;++a)u.credentialId+=n.getUint8(a).toString(16);try{var d=e.from(n.buffer,n.byteOffset+a);u.credentialPublicKey=i.a.encode(i.a.decodeFirstSync(d))}catch(p){c.a.error("Failed to decode CBOR data: ",p),u.credentialPublicKey="Decode error: ".concat(p.toString())}}return r.flags.extensionDataIncluded,r}function l(t){var n=t instanceof ArrayBuffer?e.from(t):e.from(t.buffer,t.byteOffset,t.byteLength);try{var a=i.a.decodeFirstSync(n);return a.authData&&(a.authData=u(a.authData)),a}catch(o){var r="Failed to decode attestationObject, unknown attestation type?";return c.a.error(r),r}}function f(e){var t=new TextDecoder("utf-8").decode(e);return JSON.parse(t)}function d(e){var t=Object(a.a)(e),n=Object(a.c)(r.a,["clientDataJSON","authenticatorData","attestationObject"]);return Object(a.e)(t,n),t}}).call(this,n(15).Buffer)}},[[274,1,2]]]);
//# sourceMappingURL=main.b003e364.chunk.js.map