(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{101:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return u}));n(11),n(63),n(90);var r=n(88),a=n.n(r),o=n(142),i=n.n(o);function c(t){for(var n=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),r=0,o={rpIdHash:""},c=r+32;r<c;++r)o.rpIdHash+=n.getUint8(r).toString(16);var s=n.getUint8(r++);if(o.flags={userPresent:0!==(1&s),reserved1:0!==(2&s),userVerified:0!==(4&s),reserved2:((56&s)>>>3).toString(16),attestedCredentialData:0!==(64&s),extensionDataIncluded:0!==(128&s)},o.signCount=n.getUint32(r,!1),r+=4,o.flags.attestedCredentialData){var u={};o.attestedCredentialData=u,u.aaguid="";for(var l=r+16;r<l;++r)u.aaguid+=n.getUint8(r).toString(16);u.credentialIdLength=n.getUint16(r,!1),r+=2,u.credentialId="";for(var f=r+u.credentialIdLength;r<f;++r)u.credentialId+=n.getUint8(r).toString(16);try{var d=e.from(n.buffer,n.byteOffset+r);u.credentialPublicKey=a.a.encode(a.a.decodeFirstSync(d))}catch(h){i.a.error("Failed to decode CBOR data: ",h),u.credentialPublicKey="Decode error: ".concat(h.toString())}}return o.flags.extensionDataIncluded,o}function s(t){var n=t instanceof ArrayBuffer?e.from(t):e.from(t.buffer,t.byteOffset,t.byteLength);try{var r=a.a.decodeFirstSync(n);return r.authData&&(r.authData=c(r.authData)),r}catch(s){var o="Failed to decode attestationObject, unknown attestation type?";return i.a.error(o),o}}function u(e){var t=new TextDecoder("utf-8").decode(e);return JSON.parse(t)}}).call(this,n(24).Buffer)},179:function(e,t,n){"use strict";t.a={"1.2.840.113549.1.1.11":"sha256WithRSAEncryption"}},197:function(e,t,n){e.exports=n(361)},203:function(e,t,n){},215:function(e,t){},217:function(e,t){},247:function(e,t){},361:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),o=n(20),i=n.n(o),c=(n(202),n(203),n(14)),s=n.n(c),u=n(39),l=n(3),f=n(4),d=n(126),h=n(127),m=n(364),p=n(367),b=n(363),g=n(366),y=n(148),v=(n(204),n(208),n(101),n(118)),w=n.n(v);function I(e){return fetch("/webauthn/register/v2",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}))}function S(e){return fetch("/webauthn/verify/v2",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}))}var E=n(11);function k(e){if(e instanceof Array){var t,n=[],r=Object(E.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(k(a))}}catch(c){r.e(c)}finally{r.f()}return n}if(e instanceof ArrayBuffer)return w.a.encode(e);if(e instanceof Object){var o={};for(var i in e)o[i]=k(e[i]);return o}return e}var A=m.a.TabPane,O={labelCol:{span:8},wrapperCol:{span:16}},C={wrapperCol:{offset:8,span:16}},j=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={challenge:"",userId:""},e.handleRegister=function(){var t=Object(u.a)(s.a.mark((function t(n){var r,a,o,i,c,u,l,f,d;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.username,a=n.name,o=void 0===a?"auto":a,i=e.state,c=i.userId,u=i.challenge,r&&o){t.next=5;break}return p.b.error("Name or username is missing!"),t.abrupt("return");case 5:return t.prev=5,l=e.createWebauthConfig(r,o),t.next=9,navigator.credentials.create(l);case 9:return f=t.sent,d=k(f),t.next=13,I({username:r,name:o,publicKeyCredential:d,userId:c,challenge:u});case 13:localStorage.setItem("webAuthId",d.rawId),e.setState({webAuthId:d.rawId}),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(5),p.b.error(t.t0.message);case 20:case"end":return t.stop()}}),t,null,[[5,17]])})));return function(e){return t.apply(this,arguments)}}(),e.handleLogin=function(){var t=Object(u.a)(s.a.mark((function t(n){var r,a,o,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.username2){t.next=4;break}return p.b.error("Username is missing!"),t.abrupt("return");case 4:return t.prev=4,a=e.createWebauthGetConfig(),t.next=8,navigator.credentials.get(a);case 8:return o=t.sent,i=k(o),t.next=12,S({username:r,publicKeyCredential:i});case 12:t.sent.result?p.b.success("Verified"):p.b.error("Not Verified"),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),p.b.error(t.t0.message);case 19:case"end":return t.stop()}}),t,null,[[4,16]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,r,a,o=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();case 2:if(e.sent||p.b.error("Webauthnn not support"),t=localStorage.getItem("webAuthn"),n=localStorage.getItem("webAuthId")||null,t){e.next=20;break}return e.prev=7,e.next=10,fetch("/webauthn/init",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){if("ok"!==e.status)throw new Error("Server responed with error. The message is: ".concat(e.message));return e}));case 10:r=e.sent,localStorage.setItem("webAuthn",JSON.stringify({challenge:r.challenge,userId:r.userId})),this.setState({challenge:r.challenge,userId:r.userId,webAuthId:n}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),p.b.error(e.t0.message);case 18:e.next=22;break;case 20:a=JSON.parse(t),this.setState({challenge:a.challenge,userId:a.userId,webAuthId:n});case 22:window.devState=function(){console.log(o.state)};case 23:case"end":return e.stop()}}),e,this,[[7,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"createWebauthConfig",value:function(e,t){var n=this.state,r=n.challenge,a=n.userId;return{publicKey:{challenge:Uint8Array.from(r,(function(e){return e.charCodeAt(0)})),rp:{name:"Webauthn Play",id:"webauthnplay.herokuapp.com"},user:{id:Uint8Array.from(a,(function(e){return e.charCodeAt(0)})),name:e,displayName:t},attestation:"direct",authenticatorSelection:{authenticatorAttachment:"platform"},pubKeyCredParams:[{type:"public-key",alg:-7}]}}}},{key:"createWebauthGetConfig",value:function(){var e=this.state,t=e.challenge,n=e.webAuthId;return{publicKey:{challenge:Uint8Array.from(t,(function(e){return e.charCodeAt(0)})),allowCredentials:[{type:"public-key",id:w.a.toBuffer(n),transports:["usb","ble","nfc","internal"]}]}}}},{key:"render",value:function(){return a.a.createElement("div",{className:"card-container"},a.a.createElement(m.a,{type:"card"},a.a.createElement(A,{tab:"Register",key:"1"},a.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},a.a.createElement(b.a,Object.assign({onFinish:this.handleRegister},O,{id:"form_register"}),a.a.createElement(b.a.Item,{label:"User Name",name:"username",rules:[{required:!0,message:"Please input your username!"}]},a.a.createElement(g.a,null)),a.a.createElement(b.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input your name!"}]},a.a.createElement(g.a,null)),a.a.createElement(b.a.Item,C,a.a.createElement(y.a,{type:"primary",htmlType:"submit",form:"form_register"},"Register"))))),a.a.createElement(A,{tab:"Login",key:"2"},a.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},a.a.createElement(b.a,{onFinish:this.handleLogin,id:"form_update"},a.a.createElement(b.a.Item,{label:"User Name",name:"username2",rules:[{required:!0,message:"Please input your username!"}]},a.a.createElement(g.a,null)),a.a.createElement(b.a.Item,C,a.a.createElement(y.a,{type:"primary",htmlType:"submit",form:"form_update"},"Login")))))))}}]),n}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},63:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s}));n(37);var r=n(11),a=(n(179),n(0),n(194),n(88));function o(e){var t={};for(var n in e){var r=e[n];"object"===typeof r?Array.isArray(r)||r instanceof ArrayBuffer||r&&"length"in r?t[n]=r.slice():t[n]=o(r):t[n]=r}return t}function i(e,t){var n,a={},o=Object(r.a)(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;i in e&&(a[i]=e[i])}}catch(c){o.e(c)}finally{o.f()}return a}function c(e,t){Object.keys(e).forEach((function(n){n in t&&(e[n]=t[n].transform(e[n])),"object"===typeof e[n]&&c(e[n],t)}))}function s(e){return JSON.stringify(e,null,2)}new(n.n(a).a.Encoder)({genTypes:[ArrayBuffer,function(t,n){return t.pushAny(e.from(n))}]})}).call(this,n(24).Buffer)},90:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var r=n(101),a=n(180);function o(t){if(!(t instanceof e))try{t=e.from(t)}catch(n){return""}return t.toString("hex")}var i={rawId:{transform:o,buttons:["Use","Download"]},sig:{transform:o,buttons:["Download"]},signature:{transform:o,buttons:["Download"]},userHandle:{transform:o,buttons:["Download"]},x5c:{transform:function(e){return e.map(o)},buttons:["View","Download PEM"]},credentialPublicKey:{transform:n.n(a).a,buttons:["Download COSE","Download JWK","Download PEM"]},authenticatorData:{transform:r.b},attestationObject:{transform:r.a},clientDataJSON:{transform:r.c}}}).call(this,n(24).Buffer)}},[[197,1,2]]]);
//# sourceMappingURL=main.931d6b3f.chunk.js.map