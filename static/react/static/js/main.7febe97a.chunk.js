(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{189:function(e,t,a){"use strict";(function(e){var n=a(14),r=a.n(n),o=a(40),i=a(3),s=a(4),c=a(125),u=a(133),l=a(126),f=a(2),d=a.n(f),p=a(211),m=a(81),b=a(80),y=a(157),h=a(112),g=a(150),v=(a(224),a(225),a(54)),w=a(55),O=a.n(w),D=(a(286),a(96)),E=p.a.TabPane,j={labelCol:{span:8},wrapperCol:{span:16}},C={wrapperCol:{offset:8,span:16}},S=function(t){Object(l.a)(n,t);var a=Object(u.a)(n);function n(){var t;Object(i.a)(this,n);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return(t=a.call.apply(a,[this].concat(u))).state={options:{},user:{},response:null,challenge:"",getResponse:null,isUpdate:!0},t.handleRegister=function(){var e=Object(o.a)(r.a.mark((function e(a){var n,o,i,s,u,l,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.username,o=a.name,i=void 0===o?"auto":o,n&&i){e.next=4;break}return alert("Name or username is missing!"),e.abrupt("return");case 4:return t.setState({}),Object(c.a)(t),s=t.createWebauthConfig(n,i),e.prev=7,e.next=10,navigator.credentials.create(s);case 10:u=e.sent,console.log("create credential response",u),l=Object(D.a)(u),console.log("Body 1",l),window.dev1=u,f=Object(v.a)(u.response.attestationObject),console.log("parsed credential",f),t.setState({response:Object(D.a)(u),attestation:f}),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(7),m.b.error(e.t0.message);case 23:case"end":return e.stop()}}),e,null,[[7,20]])})));return function(t){return e.apply(this,arguments)}}(),t.handleLogin=function(){var a=Object(o.a)(r.a.mark((function a(n){var o,i,s,c,u,l,f,d,p;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o=n.username2,i=t.state,s=i.response,c=i.attestation,s&&c){a.next=5;break}return m.b.error("Not registered"),a.abrupt("return");case 5:if(o){a.next=8;break}return m.b.error("Username is missing!"),a.abrupt("return");case 8:return u=t.createWebauthGetConfig(),a.prev=9,a.next=12,navigator.credentials.get(u);case 12:l=a.sent,console.log("Get credieantial response",l),window.dev2=l,t.setState({getResponse:Object(D.a)(l),parse:Object(v.d)(l)}),f=Object(D.a)(l),d=e.concat([O.a.toBuffer(l.response.authenticatorData),O.a.toBuffer(l.response.clientDataJSON)]),p=window.crypto.createVerify("SHA256").update(d).verify(c.authData.attestedCredentialData.credentialPublicKey,O.a.toBuffer(f.signature)),m.b.info(p),m.b.success("OK"),a.next=26;break;case 23:a.prev=23,a.t0=a.catch(9),m.b.error(a.t0.message);case 26:case"end":return a.stop()}}),a,null,[[9,23]])})));return function(e){return a.apply(this,arguments)}}(),t}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=Object(o.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();case 2:(t=e.sent)||m.b.error("Webauthnn not support"),console.log(t),window.parseAttestationObject=v.a,window.parseCredentials=v.d,window.parseAuthenticatorData=v.b,window.publicKeyCredentialToJSON=D.a,window.base64url=O.a;case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"createWebauthConfig",value:function(e,t){var a=new Uint8Array(32),n=new Uint8Array(32);crypto.getRandomValues(a),crypto.getRandomValues(n);var r={publicKey:{challenge:a,rp:{name:"webauthnplay.herokuapp.com"},user:{id:n,name:e,displayName:t},attestation:"direct",pubKeyCredParams:[{type:"public-key",alg:-7}],authenticatorSelection:{authenticatorAttachment:"platform"}}};return this.setState({challenge:a,user:{id:n,name:e,displayName:t},options:r}),r}},{key:"createWebauthGetConfig",value:function(){var e=this.state,t=e.challenge,a=(e.user,e.response);if(a)return{publicKey:{challenge:t,allowCredientails:[{type:"public-key",id:a.rawId}]}}}},{key:"parseCreateCredentialResponse",value:function(e){return{clientData:JSON.parse(O.a.decode(e.response.clientDataJSON)),attestationObject:Object(v.a)(O.a.toBuffer(e.response.attestationObject))}}},{key:"parseGetCredentialResponse",value:function(e){return{clientData:JSON.parse(O.a.decode(e.response.clientDataJSON)),authenticatorData:Object(v.b)(O.a.toBuffer(e.response.authenticatorData)),userHandle:O.a.decode(e.response.userHandle)}}},{key:"render",value:function(){var e=this.state,t=(e.options,e.user,e.response),a=(e.challenge,e.getResponse);return d.a.createElement("div",{className:"card-container"},d.a.createElement(p.a,{type:"card"},d.a.createElement(E,{tab:"Register",key:"1"},d.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},d.a.createElement(b.a,Object.assign({onFinish:this.handleRegister},j,{id:"form_register"}),d.a.createElement(b.a.Item,{label:"User Name",name:"username",rules:[{required:!0,message:"Please input your username!"}]},d.a.createElement(y.a,null)),d.a.createElement(b.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input your name!"}]},d.a.createElement(y.a,null)),d.a.createElement(b.a.Item,C,d.a.createElement(h.a,{type:"primary",htmlType:"submit",form:"form_register"},"Register"))))),d.a.createElement(E,{tab:"Login",key:"2"},d.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},d.a.createElement(b.a,{onFinish:this.handleLogin,id:"form_update"},d.a.createElement(b.a.Item,{label:"User Name",name:"username2",rules:[{required:!0,message:"Please input your username!"}]},d.a.createElement(y.a,null)),d.a.createElement(b.a.Item,C,d.a.createElement(h.a,{type:"primary",htmlType:"submit",form:"form_update"},"Login")))))),t?d.a.createElement("div",null," ",d.a.createElement("p",null,"Create Credential Response")," ",d.a.createElement("br",null),d.a.createElement(g.a,{value:{raw:t,parsed:this.parseCreateCredentialResponse(t)}})):d.a.createElement("div",null),a?d.a.createElement("div",null,d.a.createElement("p",null,"Get Credential Response")," ",d.a.createElement("br",null),d.a.createElement(g.a,{value:{raw:a,parsed:this.parseGetCredentialResponse(a)}})):d.a.createElement("div",null))}}]),n}(d.a.Component);t.a=S}).call(this,a(23).Buffer)},193:function(e,t,a){"use strict";t.a={"1.2.840.113549.1.1.11":"sha256WithRSAEncryption"}},212:function(e,t,a){e.exports=a(389)},218:function(e,t,a){},248:function(e,t){},250:function(e,t){},280:function(e,t){},286:function(e,t,a){"use strict"},389:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),o=a(20),i=a.n(o),s=(a(217),a(218),a(189));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(s.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},54:function(e,t,a){"use strict";(function(e){a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return f})),a.d(t,"d",(function(){return d}));a(11);var n=a(67),r=a(95),o=a(93),i=a.n(o),s=a(151),c=a.n(s);function u(t){for(var a=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),n=0,r={rpIdHash:""},o=n+32;n<o;++n)r.rpIdHash+=a.getUint8(n).toString(16);var s=a.getUint8(n++);if(r.flags={userPresent:0!==(1&s),reserved1:0!==(2&s),userVerified:0!==(4&s),reserved2:((56&s)>>>3).toString(16),attestedCredentialData:0!==(64&s),extensionDataIncluded:0!==(128&s)},r.signCount=a.getUint32(n,!1),n+=4,r.flags.attestedCredentialData){var u={};r.attestedCredentialData=u,u.aaguid="";for(var l=n+16;n<l;++n)u.aaguid+=a.getUint8(n).toString(16);u.credentialIdLength=a.getUint16(n,!1),n+=2,u.credentialId="";for(var f=n+u.credentialIdLength;n<f;++n)u.credentialId+=a.getUint8(n).toString(16);try{var d=e.from(a.buffer,a.byteOffset+n);u.credentialPublicKey=i.a.encode(i.a.decodeFirstSync(d))}catch(p){c.a.error("Failed to decode CBOR data: ",p),u.credentialPublicKey="Decode error: ".concat(p.toString())}}return r.flags.extensionDataIncluded,r}function l(t){var a=t instanceof ArrayBuffer?e.from(t):e.from(t.buffer,t.byteOffset,t.byteLength);try{var n=i.a.decodeFirstSync(a);return n.authData&&(n.authData=u(n.authData)),n}catch(o){var r="Failed to decode attestationObject, unknown attestation type?";return c.a.error(r),r}}function f(e){var t=new TextDecoder("utf-8").decode(e);return JSON.parse(t)}function d(e){var t=Object(n.a)(e),a=Object(n.b)(r.a,["clientDataJSON","authenticatorData","attestationObject"]);return Object(n.d)(t,a),t}}).call(this,a(23).Buffer)},67:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return c}));a(38);var n=a(11),r=(a(193),a(0),a(208),a(93));function o(e){var t={};for(var a in e){var n=e[a];"object"===typeof n?Array.isArray(n)||n instanceof ArrayBuffer||n&&"length"in n?t[a]=n.slice():t[a]=o(n):t[a]=n}return t}function i(e,t){var a,r={},o=Object(n.a)(t);try{for(o.s();!(a=o.n()).done;){var i=a.value;i in e&&(r[i]=e[i])}}catch(s){o.e(s)}finally{o.f()}return r}function s(e,t){Object.keys(e).forEach((function(a){a in t&&(e[a]=t[a].transform(e[a])),"object"===typeof e[a]&&s(e[a],t)}))}function c(e){return JSON.stringify(e,null,2)}new(a.n(r).a.Encoder)({genTypes:[ArrayBuffer,function(t,a){return t.pushAny(e.from(a))}]})}).call(this,a(23).Buffer)},95:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return i}));var n=a(54),r=a(194);function o(t){if(!(t instanceof e))try{t=e.from(t)}catch(a){return""}return t.toString("hex")}var i={rawId:{transform:o,buttons:["Use","Download"]},sig:{transform:o,buttons:["Download"]},signature:{transform:o,buttons:["Download"]},userHandle:{transform:o,buttons:["Download"]},x5c:{transform:function(e){return e.map(o)},buttons:["View","Download PEM"]},credentialPublicKey:{transform:a.n(r).a,buttons:["Download COSE","Download JWK","Download PEM"]},authenticatorData:{transform:n.b},attestationObject:{transform:n.a},clientDataJSON:{transform:n.c}}}).call(this,a(23).Buffer)},96:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(11),r=a(55),o=a.n(r);function i(e){if(e instanceof Array){var t,a=[],r=Object(n.a)(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;a.push(i(s))}}catch(l){r.e(l)}finally{r.f()}return a}if(e instanceof ArrayBuffer)return o.a.encode(e);if(e instanceof Object){var c={};for(var u in e)c[u]=i(e[u]);return c}return e}}},[[212,1,2]]]);
//# sourceMappingURL=main.7febe97a.chunk.js.map